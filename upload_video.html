<!DOCTYPE html>
<html>
    <head>
        <title>Good Deed Marathon</title> 

        <meta http-equiv="content-type" content="text/html;charset=iso-8859-1" />
        <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="phonegap.js"></script>
        <script>


            function captureSuccess(mediaFiles) {
            mediaFiles[0].getFormatData(function(data) {
            if(data.duration > 15) {
            alert("Your video is longer than the allowed 15 seconds. Please record a new video. You can trim your video after it's been recorded.");
            } else {
            uploadFile(mediaFiles[0]);
            }
            });


            }


            function captureError(error) {
            var msg = 'An error occurred during capture: ' + error.code;
            navigator.notification.alert(msg, null, 'Uh oh!');
            }


            function captureVideo() {

            navigator.device.capture.captureVideo(captureSuccess, captureError, {limit: 1,duration:15});
            }


            function uploadFile(mediaFile) {
            var ft = new FileTransfer(),
            path = mediaFile.fullPath,
            name = mediaFile.name;

            ft.upload(path,
            "http://www.gooddeedmarathon.com/vupload.php",
            function(result) {
            console.log('Upload success: ' + result.responseCode);
            console.log(result.bytesSent + ' bytes sent');
            },
            function(error) {
            console.log('Error uploading file ' + path + ': ' + error.code);
            },
            { fileName: name });   
            }
            
        </script>
    </head>
    <body>
        <button onclick="captureVideo();">Capture Video</button> <br>
        <div id="status"></div>
    </body>
</html>